<!doctype html>
<html>

<head>
    <title>SF Parking Meter Map</title>

    <link rel="stylesheet" type="text/css" href="css/map.css">
    <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>

    <script type="text/javascript">
        //http://bl.ocks.org/mbostock/899711
        //https://developers.google.com/maps/articles/toomanymarkers
        //code assistance from Eric Field at UVA Architecture

        var map = ""; // create a map variable, with Global scope.
        var markersArray = []; // create array to hold markers
        var data;

        function initialize() {
            // setup some options
            var mapCenterLatLong = new google.maps.LatLng(37.773972, -122.431297);

            var mapOptions = {
                center: mapCenterLatLong,
                zoom: 13,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            // create the map, in the DIV defined, using the options set just above.
            map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

            // create the markers
            getData();

            // http://googlemaps.github.io/js-samples/styledmaps/wizard/index.html
            var styles = [
                {
                    "featureType": "water",
                    "stylers": [
                        {
                            "hue": "#0000ff"
                        }
                    ]
                  }, {}
                ]
            map.setOptions({
                styles: styles
            });
        }

        function setMarkers(markerData) {
            // define a single marker (a pin point on the map)
            var lat = markerData["LOCATION"].split(",")[0].replace("\(", "");
            var long = markerData["LOCATION"].split(",")[1].replace("\)", "");
            //console.log(long);
            var myLatLong = new google.maps.LatLng(lat, long);
            var marker = new google.maps.Marker({
                position: myLatLong,
                map: map,
                //                icon:  {
                //                      path: google.maps.SymbolPath.CIRCLE,
                //                      scale: 1,
                //                      fillColor: "#FF4C00",
                //                      fillOpacity: 0.5,
                //                      strokeWeight: 1,
                //                      strokeColor: "#333333"
                //                },
            });

            // add the marker to the array
            markersArray.push(marker);
        }


        function getData() {
            d3.csv("data/Parking_meters.csv", function (d) {
                data = d;
                data.forEach(function (d) {
                    setMarkers(d);
                });
            })
        }
    </script>
</head>

<body onload="initialize()">
    <h3 id="header">San Francisco Parking Meters</h3>
    <h3 id="subheader">Access this dataset <a href="https://data.sfgov.org/Transportation/Parking-meters/28my-4796">here</a>!</h3>
    <p>
        <button class="button" onclick="location.href='../index.html'">HOME</button>
    </p>

    <div id="map_canvas" style="width:1000px; height:600px;"></div>

</body>

</html>